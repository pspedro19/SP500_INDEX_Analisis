2025-05-23 09:24:34,166 - INFO - ================================================================================
2025-05-23 09:24:34,167 - INFO - INICIANDO PROCESO DE SELECCIÓN DE FEATURES POR FPI
2025-05-23 09:24:34,168 - INFO - ================================================================================
2025-05-23 09:24:34,169 - INFO - Timestamp: 20250523_092434
2025-05-23 09:24:34,169 - INFO - Directorio de entrada: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\2_processed
2025-05-23 09:24:34,170 - INFO - Directorio de salida: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\3_trainingdata
2025-05-23 09:24:34,171 - INFO - Directorio de logs: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\logs
2025-05-23 09:24:34,172 - INFO - Archivo de log: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\logs\fpi_selection_20250523_092434.log
2025-05-23 09:24:34,174 - INFO - Período de forecasting: 1MONTH
2025-05-23 09:24:34,174 - INFO - Gap para CV: 20 días
2025-05-23 09:24:34,175 - INFO - Número de splits CV: 5
2025-05-23 09:24:34,176 - INFO - Threshold FPI: 1e-06
2025-05-23 09:24:34,176 - INFO - Aplicar escalado: False
2025-05-23 09:24:34,177 - INFO - Semilla aleatoria: 42
2025-05-23 09:24:34,178 - INFO - Parámetros CatBoost: {'loss_function': 'RMSE', 'eval_metric': 'RMSE', 'early_stopping_rounds': 50, 'verbose': 0, 'random_seed': 42, 'n_estimators': 500, 'learning_rate': 0.01, 'max_depth': 8}
2025-05-23 09:24:34,180 - INFO - ================================================================================
2025-05-23 09:24:34,182 - INFO - ============================================================
2025-05-23 09:24:34,183 - INFO - INICIANDO SELECCIÓN DE FEATURES FPI
2025-05-23 09:24:34,184 - INFO - ============================================================
2025-05-23 09:24:34,186 - INFO - Usando el archivo más reciente: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\2_processed\ULTIMO_S&P500_final.xlsx
2025-05-23 09:24:34,187 - INFO - La salida se guardará en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\3_trainingdata\ULTIMO_S&P500_final_FPI.xlsx
2025-05-23 09:24:38,368 - INFO - Archivo 'C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\2_processed\ULTIMO_S&P500_final.xlsx' cargado con forma (2241, 243).
2025-05-23 09:24:38,384 - INFO - Memoria utilizada: 4.26 MB
2025-05-23 09:24:38,385 - INFO - Columnas del DataFrame original: ['date', 'MoM_PRICE_Australia_10Y_Bond_bond', 'log_diff_PRICE_Australia_10Y_Bond_bond', 'MoM_PRICE_Italy_10Y_Bond_bond', 'log_diff_PRICE_Italy_10Y_Bond_bond', 'rolling_var_PRICE_Italy_10Y_Bond_bond', 'zscore_PRICE_Italy_10Y_Bond_bond', 'MoM_PRICE_Japan_10Y_Bond_bond', 'YoY_PRICE_Japan_10Y_Bond_bond', 'log_diff_PRICE_Japan_10Y_Bond_bond', 'rolling_var_PRICE_Japan_10Y_Bond_bond', '3M_change_PRICE_Japan_10Y_Bond_bond', '6M_change_PRICE_Japan_10Y_Bond_bond', 'YTD_PRICE_Japan_10Y_Bond_bond', 'zscore_PRICE_Japan_10Y_Bond_bond', 'MoM_PRICE_UK_10Y_Bond_bond', 'log_diff_PRICE_UK_10Y_Bond_bond', '3M_change_PRICE_UK_10Y_Bond_bond', 'zscore_PRICE_UK_10Y_Bond_bond', 'MoM_PRICE_Germany_10Y_Bond_bond', 'YoY_PRICE_Germany_10Y_Bond_bond', 'log_diff_PRICE_Germany_10Y_Bond_bond', '3M_change_PRICE_Germany_10Y_Bond_bond', '6M_change_PRICE_Germany_10Y_Bond_bond', 'log_diff_PRICE_Canada_10Y_Bond_bond', 'rolling_var_PRICE_Canada_10Y_Bond_bond', 'MoM_PRICE_China_10Y_Bond_bond', 'log_diff_PRICE_China_10Y_Bond_bond', 'zscore_PRICE_China_10Y_Bond_bond', 'YoY_PRICE_Colombia_5_Year_Bond_bond', 'log_diff_PRICE_Colombia_5_Year_Bond_bond', 'rolling_var_PRICE_Colombia_5_Year_Bond_bond', 'MoM_PRICE_Colombia_10_Year_Bond_bond', 'log_diff_PRICE_Colombia_10_Year_Bond_bond', 'zscore_PRICE_Colombia_10_Year_Bond_bond', 'MoM_AAA_Corporate_Bond_AAA_Spread_bond', 'YoY_AAA_Corporate_Bond_AAA_Spread_bond', 'log_diff_AAA_Corporate_Bond_AAA_Spread_bond', 'rolling_var_AAA_Corporate_Bond_AAA_Spread_bond', '3M_change_AAA_Corporate_Bond_AAA_Spread_bond', '6M_change_AAA_Corporate_Bond_AAA_Spread_bond', 'zscore_AAA_Corporate_Bond_AAA_Spread_bond', 'log_diff_DGS10_DGS10_bond', 'MoM_Actual_U.S. All Car Sales_car_registrations', 'YoY_Actual_U.S. All Car Sales_car_registrations', 'Abs_Change_Actual_U.S. All Car Sales_car_registrations', 'log_diff_Actual_U.S. All Car Sales_car_registrations', '3M_change_Actual_U.S. All Car Sales_car_registrations', '6M_change_Actual_U.S. All Car Sales_car_registrations', 'zscore_Actual_U.S. All Car Sales_car_registrations', 'momentum_PRICE_CrudeOil_WTI_commodities', '3M_change_PRICE_CrudeOil_WTI_commodities', 'log_diff_PRICE_Gold_Spot_commodities', 'momentum_PRICE_Gold_Spot_commodities', 'log_diff_PRICE_Silver_Spot_commodities', 'rolling_var_PRICE_Silver_Spot_commodities', 'momentum_PRICE_Silver_Spot_commodities', 'zscore_PRICE_Silver_Spot_commodities', 'log_diff_PRICE_Copper_Futures_commodities', 'rolling_var_PRICE_Copper_Futures_commodities', 'MACD_signal_PRICE_Copper_Futures_commodities', 'momentum_PRICE_Copper_Futures_commodities', 'log_diff_PRICE_Platinum_Spot_commodities', 'momentum_PRICE_Platinum_Spot_commodities', '3M_change_PRICE_Platinum_Spot_commodities', 'log_diff_PRICE_Lead_Futures_commodities', 'MACD_signal_PRICE_Lead_Futures_commodities', 'momentum_PRICE_Lead_Futures_commodities', '3M_change_PRICE_Lead_Futures_commodities', 'log_diff_PRICE_Palladium_Futures_commodities', 'momentum_PRICE_Palladium_Futures_commodities', 'zscore_PRICE_Palladium_Futures_commodities', 'log_diff_PRICE_Tin_Futures_commodities', 'rolling_var_PRICE_Tin_Futures_commodities', 'momentum_PRICE_Tin_Futures_commodities', 'zscore_PRICE_Tin_Futures_commodities', 'log_diff_PRICE_Zinc_Futures_commodities', 'rolling_var_PRICE_Zinc_Futures_commodities', 'momentum_PRICE_Zinc_Futures_commodities', 'log_diff_PRICE_Nickel_Futures_commodities', 'rolling_var_PRICE_Nickel_Futures_commodities', 'MACD_signal_PRICE_Nickel_Futures_commodities', 'momentum_PRICE_Nickel_Futures_commodities', 'zscore_PRICE_Nickel_Futures_commodities', 'log_diff_PRICE_Iron_ore_fines_62%_Fe_CFR_Futures_commodities', 'rolling_std_PRICE_Iron_ore_fines_62%_Fe_CFR_Futures_commodities', 'MACD_signal_PRICE_Iron_ore_fines_62%_Fe_CFR_Futures_commodities', 'momentum_PRICE_Iron_ore_fines_62%_Fe_CFR_Futures_commodities', '6M_change_PRICE_Iron_ore_fines_62%_Fe_CFR_Futures_commodities', 'log_diff_PRICE_Brent_Oil_Futures_commodities', 'zscore_PRICE_Brent_Oil_Futures_commodities', 'MoM_Actual_Japan_M2_MoneySupply_YoY_economics', 'log_diff_Actual_Japan_M2_MoneySupply_YoY_economics', '3M_change_Actual_Japan_M2_MoneySupply_YoY_economics', '6M_change_Actual_Japan_M2_MoneySupply_YoY_economics', 'zscore_Actual_Japan_M2_MoneySupply_YoY_economics', 'MoM_Actual_China_M2_MoneySupply_YoY_economics', 'YoY_Actual_China_M2_MoneySupply_YoY_economics', 'log_diff_Actual_China_M2_MoneySupply_YoY_economics', '3M_change_Actual_China_M2_MoneySupply_YoY_economics', '6M_change_Actual_China_M2_MoneySupply_YoY_economics', 'zscore_Actual_China_M2_MoneySupply_YoY_economics', 'MoM_Actual_Mexico_CPI_MoM_economics', 'YoY_Actual_Mexico_CPI_MoM_economics', 'log_Actual_Mexico_CPI_MoM_economics', 'log_diff_Actual_Mexico_CPI_MoM_economics', '3M_change_Actual_Mexico_CPI_MoM_economics', '6M_change_Actual_Mexico_CPI_MoM_economics', 'YTD_Actual_Mexico_CPI_MoM_economics', 'zscore_Actual_Mexico_CPI_MoM_economics', 'MoM_Actual_UK_Retail_Sales_MoM_economics', 'YoY_Actual_UK_Retail_Sales_MoM_economics', 'log_Actual_UK_Retail_Sales_MoM_economics', 'log_diff_Actual_UK_Retail_Sales_MoM_economics', '3M_change_Actual_UK_Retail_Sales_MoM_economics', '6M_change_Actual_UK_Retail_Sales_MoM_economics', 'YTD_Actual_UK_Retail_Sales_MoM_economics', 'zscore_Actual_UK_Retail_Sales_MoM_economics', 'MoM_Actual_US_ConferenceBoard_LEI_leading_economic_index', 'YoY_Actual_US_ConferenceBoard_LEI_leading_economic_index', 'log_diff_Actual_US_ConferenceBoard_LEI_leading_economic_index', '3M_change_Actual_US_ConferenceBoard_LEI_leading_economic_index', '6M_change_Actual_US_ConferenceBoard_LEI_leading_economic_index', 'zscore_Actual_US_ConferenceBoard_LEI_leading_economic_index', 'MoM_Actual_Japan_Leading_Indicator_leading_economic_index', 'log_diff_Actual_Japan_Leading_Indicator_leading_economic_index', '3M_change_Actual_Japan_Leading_Indicator_leading_economic_index', 'YTD_Actual_Japan_Leading_Indicator_leading_economic_index', 'zscore_Actual_Japan_Leading_Indicator_leading_economic_index', 'MoM_Actual_IPC Colombia_economics', 'YoY_Actual_IPC Colombia_economics', 'log_diff_Actual_IPC Colombia_economics', '3M_change_Actual_IPC Colombia_economics', 'YTD_Actual_IPC Colombia_economics', 'zscore_Actual_IPC Colombia_economics', 'MoM_Actual_IPC EEUU_economics', 'YoY_Actual_IPC EEUU_economics', 'log_diff_Actual_IPC EEUU_economics', '3M_change_Actual_IPC EEUU_economics', '6M_change_Actual_IPC EEUU_economics', 'zscore_Actual_IPC EEUU_economics', 'rolling_var_PRICE_EUR_USD_Spot_exchange_rate', 'zscore_PRICE_EUR_USD_Spot_exchange_rate', 'log_diff_PRICE_JPY_USD_Spot_exchange_rate', 'rolling_var_PRICE_JPY_USD_Spot_exchange_rate', 'log_diff_PRICE_CNY_USD_Spot_exchange_rate', 'momentum_PRICE_CNY_USD_Spot_exchange_rate', '6M_change_PRICE_CNY_USD_Spot_exchange_rate', 'zscore_PRICE_CNY_USD_Spot_exchange_rate', 'log_diff_PRICE_AUD_USD_Spot_exchange_rate', 'momentum_PRICE_AUD_USD_Spot_exchange_rate', 'log_diff_PRICE_CAD_USD_Spot_exchange_rate', 'rolling_var_PRICE_CAD_USD_Spot_exchange_rate', 'momentum_PRICE_CAD_USD_Spot_exchange_rate', 'zscore_PRICE_CAD_USD_Spot_exchange_rate', 'log_diff_PRICE_MXN_USD_Spot_exchange_rate', 'momentum_PRICE_MXN_USD_Spot_exchange_rate', 'zscore_PRICE_MXN_USD_Spot_exchange_rate', 'log_diff_PRICE_EUR_GBP_Cross_exchange_rate', 'rolling_var_PRICE_EUR_GBP_Cross_exchange_rate', 'MACD_signal_PRICE_EUR_GBP_Cross_exchange_rate', 'momentum_PRICE_EUR_GBP_Cross_exchange_rate', '6M_change_PRICE_EUR_GBP_Cross_exchange_rate', 'zscore_PRICE_EUR_GBP_Cross_exchange_rate', 'log_diff_PRICE_JPY_EUR_exchange_rate', 'momentum_PRICE_JPY_EUR_exchange_rate', '3M_change_PRICE_JPY_EUR_exchange_rate', 'log_diff_PRICE_BRL_NZD_exchange_rate', 'rolling_var_PRICE_BRL_NZD_exchange_rate', 'MACD_signal_PRICE_BRL_NZD_exchange_rate', 'momentum_PRICE_BRL_NZD_exchange_rate', '3M_change_PRICE_BRL_NZD_exchange_rate', 'log_diff_PRICE_NOK_AUD_exchange_rate', 'rolling_var_PRICE_NOK_AUD_exchange_rate', 'MACD_PRICE_NOK_AUD_exchange_rate', 'momentum_PRICE_NOK_AUD_exchange_rate', '3M_change_PRICE_NOK_AUD_exchange_rate', '6M_change_PRICE_NOK_AUD_exchange_rate', 'log_diff_PRICE_PHP_ZAR_exchange_rate', 'rolling_var_PRICE_PHP_ZAR_exchange_rate', 'MACD_signal_PRICE_PHP_ZAR_exchange_rate', 'momentum_PRICE_PHP_ZAR_exchange_rate', 'log_diff_PRICE_USDCOP-US_Dollar_Colombian_Peso_exchange_rate', 'momentum_PRICE_USDCOP-US_Dollar_Colombian_Peso_exchange_rate', 'MoM_Actual_Singapore_NonOil_Exports_YoY_economics', 'YoY_Actual_Singapore_NonOil_Exports_YoY_economics', 'log_Actual_Singapore_NonOil_Exports_YoY_economics', 'log_diff_Actual_Singapore_NonOil_Exports_YoY_economics', '3M_change_Actual_Singapore_NonOil_Exports_YoY_economics', '6M_change_Actual_Singapore_NonOil_Exports_YoY_economics', 'YTD_Actual_Singapore_NonOil_Exports_YoY_economics', 'zscore_Actual_Singapore_NonOil_Exports_YoY_economics', 'MoM_Actual_China_Exports_exports', 'YoY_Actual_China_Exports_exports', 'log_Actual_China_Exports_exports', 'log_diff_Actual_China_Exports_exports', '3M_change_Actual_China_Exports_exports', '6M_change_Actual_China_Exports_exports', 'YTD_Actual_China_Exports_exports', 'zscore_Actual_China_Exports_exports', 'momentum_PRICE_Russell_2000_index_pricing', 'zscore_PRICE_Russell_2000_index_pricing', 'zscore_PRICE_FTSE_100_index_pricing', 'log_diff_PRICE_Nikkei_225_index_pricing', 'rolling_var_PRICE_Nikkei_225_index_pricing', 'momentum_PRICE_Nikkei_225_index_pricing', 'momentum_PRICE_DAX_30_index_pricing', 'log_diff_PRICE_Shanghai_Composite_index_pricing', 'rolling_std_PRICE_Shanghai_Composite_index_pricing', 'momentum_PRICE_Shanghai_Composite_index_pricing', '3M_change_PRICE_Shanghai_Composite_index_pricing', 'zscore_PRICE_Shanghai_Composite_index_pricing', 'log_diff_PRICE_VIX_VolatilityIndex_index_pricing', 'momentum_PRICE_VIX_VolatilityIndex_index_pricing', 'zscore_PRICE_VIX_VolatilityIndex_index_pricing', 'log_diff_PRICE_Dow_Jones_Industrial_Average_index_pricing', 'log_diff_PRICE_CAC_40_index_pricing', 'log_diff_DTWEXBGS_Dollar_Index_DXY_index_pricing', 'MoM_Actual_Eurozone_Unemployment_Rate_unemployment_rate', 'log_diff_Actual_Eurozone_Unemployment_Rate_unemployment_rate', '3M_change_Actual_Eurozone_Unemployment_Rate_unemployment_rate', '6M_change_Actual_Eurozone_Unemployment_Rate_unemployment_rate', 'zscore_Actual_Eurozone_Unemployment_Rate_unemployment_rate', 'MoM_UNRATE_US_Unemployment_Rate_unemployment_rate', '3M_change_UNRATE_US_Unemployment_Rate_unemployment_rate', 'zscore_UNRATE_US_Unemployment_Rate_unemployment_rate', 'log_diff_PAYEMS_US_Nonfarm_Payrolls_unemployment_rate', '6M_change_PAYEMS_US_Nonfarm_Payrolls_unemployment_rate', 'MoM_ICSA_US_Initial_Jobless_Claims_unemployment_rate', 'log_diff_ICSA_US_Initial_Jobless_Claims_unemployment_rate', 'zscore_ICSA_US_Initial_Jobless_Claims_unemployment_rate', 'ESI_GACDISA_US_Empire_State_Index_business_confidence', 'ESI_AWCDISA_US_Empire_State_Index_business_confidence', 'Actual_US_Philly_Fed_Index_business_confidence', 'DNKSLRTCR03GPSAM_Denmark_Car_Registrations_MoM', 'USASLRTCR03GPSAM_US_Car_Registrations_MoM', 'ZAFSLRTCR03GPSAM_SouthAfrica_Car_Registrations_MoM', 'GBRSLRTCR03GPSAM_United_Kingdom_Car_Registrations_MoM', 'CSCICP02CHQ460S_Switzerland_Consumer_Confidence_consumer_confidence', 'GDP_US_GDP_Growth_economics', 'ECBDFR_ECB_Deposit_Rate_economics', 'PRICE_S&P500_Index_index_pricing_Return_Target', 'PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20']
2025-05-23 09:24:38,389 - INFO - Tipos de datos: 
date                                                                    object
MoM_PRICE_Australia_10Y_Bond_bond                                      float64
log_diff_PRICE_Australia_10Y_Bond_bond                                 float64
MoM_PRICE_Italy_10Y_Bond_bond                                          float64
log_diff_PRICE_Italy_10Y_Bond_bond                                     float64
                                                                        ...   
CSCICP02CHQ460S_Switzerland_Consumer_Confidence_consumer_confidence    float64
GDP_US_GDP_Growth_economics                                            float64
ECBDFR_ECB_Deposit_Rate_economics                                      float64
PRICE_S&P500_Index_index_pricing_Return_Target                         float64
PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20               float64
Length: 243, dtype: object
2025-05-23 09:24:38,402 - INFO - Primeras 3 filas (head) del DataFrame original:
         date  MoM_PRICE_Australia_10Y_Bond_bond  \
0  2015-01-30                          -0.138879   
1  2015-02-02                          -0.133549   
2  2015-02-03                          -0.121423   

   log_diff_PRICE_Australia_10Y_Bond_bond  MoM_PRICE_Italy_10Y_Bond_bond  \
0                               -0.010879                      -0.048323   
1                               -0.019475                      -0.077476   
2                               -0.003528                      -0.104975   

   log_diff_PRICE_Italy_10Y_Bond_bond  rolling_var_PRICE_Italy_10Y_Bond_bond  \
0                            0.009393                               0.011581   
1                           -0.002621                               0.011456   
2                           -0.011312                               0.011197   

   zscore_PRICE_Italy_10Y_Bond_bond  MoM_PRICE_Japan_10Y_Bond_bond  \
0                         -1.312309                      -0.133333   
1                         -1.309352                      -0.110769   
2                         -1.409764                       0.263889   

   YoY_PRICE_Japan_10Y_Bond_bond  log_diff_PRICE_Japan_10Y_Bond_bond  ...  \
0                      -0.534202                           -0.006202  ...   
1                      -0.523888                            0.002330  ...   
2                      -0.391304                            0.056555  ...   

   Actual_US_Philly_Fed_Index_business_confidence  \
0                                             6.3   
1                                             6.3   
2                                             6.3   

   DNKSLRTCR03GPSAM_Denmark_Car_Registrations_MoM  \
0                                        1.443237   
1                                       -8.411215   
2                                       -8.411215   

   USASLRTCR03GPSAM_US_Car_Registrations_MoM  \
0                                  -6.242071   
1                                  -2.381597   
2                                  -2.381597   

   ZAFSLRTCR03GPSAM_SouthAfrica_Car_Registrations_MoM  \
0                                         -10.950570    
1                                          -1.280956    
2                                          -1.280956    

   GBRSLRTCR03GPSAM_United_Kingdom_Car_Registrations_MoM  \
0                                           0.265793       
1                                          -1.712259       
2                                          -1.712259       

   CSCICP02CHQ460S_Switzerland_Consumer_Confidence_consumer_confidence  \
0                                          -13.48804                     
1                                          -13.48804                     
2                                          -13.48804                     

   GDP_US_GDP_Growth_economics  ECBDFR_ECB_Deposit_Rate_economics  \
0                    18063.529                               -0.2   
1                    18063.529                               -0.2   
2                    18063.529                               -0.2   

   PRICE_S&P500_Index_index_pricing_Return_Target  \
0                                        0.054887   
1                                        0.047803   
2                                        0.028195   

   PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20  
0                                          -0.020670         
1                                          -0.014735         
2                                          -0.018930         

[3 rows x 243 columns]
2025-05-23 09:24:38,410 - INFO - Últimas 3 filas (tail) del DataFrame original:
            date  MoM_PRICE_Australia_10Y_Bond_bond  \
2238  2025-03-26                           0.027114   
2239  2025-03-27                           0.038868   
2240  2025-03-28                           0.037837   

      log_diff_PRICE_Australia_10Y_Bond_bond  MoM_PRICE_Italy_10Y_Bond_bond  \
2238                                0.006603                       0.116179   
2239                                0.008556                       0.113121   
2240                               -0.008373                       0.108520   

      log_diff_PRICE_Italy_10Y_Bond_bond  \
2238                            0.000204   
2239                           -0.002867   
2240                           -0.005345   

      rolling_var_PRICE_Italy_10Y_Bond_bond  zscore_PRICE_Italy_10Y_Bond_bond  \
2238                               0.024906                          1.443846   
2239                               0.019087                          1.306589   
2240                               0.012060                          1.105687   

      MoM_PRICE_Japan_10Y_Bond_bond  YoY_PRICE_Japan_10Y_Bond_bond  \
2238                       0.150554                       0.988520   
2239                       0.131789                       0.991083   
2240                       0.123529                       0.919598   

      log_diff_PRICE_Japan_10Y_Bond_bond  ...  \
2238                            0.003523  ...   
2239                            0.001562  ...   
2240                           -0.013750  ...   

      Actual_US_Philly_Fed_Index_business_confidence  \
2238                                            12.5   
2239                                            12.5   
2240                                            12.5   

      DNKSLRTCR03GPSAM_Denmark_Car_Registrations_MoM  \
2238                                        4.014864   
2239                                        4.014864   
2240                                        4.014864   

      USASLRTCR03GPSAM_US_Car_Registrations_MoM  \
2238                                   4.418522   
2239                                   4.418522   
2240                                   4.418522   

      ZAFSLRTCR03GPSAM_SouthAfrica_Car_Registrations_MoM  \
2238                                          -7.384883    
2239                                          -7.384883    
2240                                          -7.384883    

      GBRSLRTCR03GPSAM_United_Kingdom_Car_Registrations_MoM  \
2238                                           -2.60193       
2239                                           -2.60193       
2240                                           -2.60193       

      CSCICP02CHQ460S_Switzerland_Consumer_Confidence_consumer_confidence  \
2238                                          -31.11702                     
2239                                          -31.11702                     
2240                                          -31.11702                     

      GDP_US_GDP_Growth_economics  ECBDFR_ECB_Deposit_Rate_economics  \
2238                    29977.632                                2.5   
2239                    29977.632                                2.5   
2240                    29977.632                                2.5   

      PRICE_S&P500_Index_index_pricing_Return_Target  \
2238                                       -0.058881   
2239                                       -0.036629   
2240                                       -0.009986   

      PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20  
2238                                                NaN         
2239                                                NaN         
2240                                                NaN         

[3 rows x 243 columns]
2025-05-23 09:24:38,410 - INFO - Estadísticas básicas de algunas columnas numéricas:
2025-05-23 09:24:38,415 - INFO -   - MoM_PRICE_Australia_10Y_Bond_bond: min=-0.4353, max=0.6429, mean=0.0065, std=0.1104
2025-05-23 09:24:38,418 - INFO -   - log_diff_PRICE_Australia_10Y_Bond_bond: min=-0.1590, max=0.1590, mean=0.0003, std=0.0164
2025-05-23 09:24:38,420 - INFO -   - MoM_PRICE_Italy_10Y_Bond_bond: min=-0.5164, max=1.6486, mean=0.0157, std=0.1766
2025-05-23 09:24:38,423 - INFO -   - log_diff_PRICE_Italy_10Y_Bond_bond: min=-0.2150, max=0.2809, mean=0.0002, std=0.0221
2025-05-23 09:24:38,426 - INFO -   - rolling_var_PRICE_Italy_10Y_Bond_bond: min=0.0004, max=0.2605, mean=0.0165, std=0.0260
2025-05-23 09:24:38,430 - INFO - Convirtiendo columna 'date' a datetime...
2025-05-23 09:24:38,595 - INFO - Fechas inválidas (NaT) encontradas: 0
2025-05-23 09:24:38,597 - INFO - Rango de fechas después de limpiar: 2015-01-30 00:00:00 a 2025-03-28 00:00:00
2025-05-23 09:24:38,598 - INFO - Cantidad de fechas únicas: 2241
2025-05-23 09:24:38,598 - INFO - Días calendario totales en el rango: 3711
2025-05-23 09:24:38,599 - INFO - Cobertura de fechas: 60.4% del rango total
2025-05-23 09:24:38,599 - INFO - Construyendo calendario de días hábiles para NYSE...
2025-05-23 09:24:38,880 - INFO - Días hábiles (NYSE) en el rango: 2556
2025-05-23 09:24:38,882 - INFO - Primeros 5 días hábiles: [Timestamp('2015-01-30 00:00:00'), Timestamp('2015-02-02 00:00:00'), Timestamp('2015-02-03 00:00:00'), Timestamp('2015-02-04 00:00:00'), Timestamp('2015-02-05 00:00:00')]
2025-05-23 09:24:38,883 - INFO - Últimos 5 días hábiles: [Timestamp('2025-03-24 00:00:00'), Timestamp('2025-03-25 00:00:00'), Timestamp('2025-03-26 00:00:00'), Timestamp('2025-03-27 00:00:00'), Timestamp('2025-03-28 00:00:00')]
2025-05-23 09:24:38,883 - INFO - Rango total días hábiles: 2015-01-30 00:00:00 a 2025-03-28 00:00:00
2025-05-23 09:24:38,890 - WARNING - Ejemplos de días hábiles faltantes: [Timestamp('2015-06-18 00:00:00'), Timestamp('2015-06-19 00:00:00'), Timestamp('2015-06-22 00:00:00'), Timestamp('2015-06-23 00:00:00'), Timestamp('2015-06-24 00:00:00')]
2025-05-23 09:24:38,894 - INFO - Filas totales antes de filtrar por días hábiles: 2241
2025-05-23 09:24:38,895 - INFO - Filas totales después de filtrar por días hábiles: 2162
2025-05-23 09:24:38,896 - INFO - Filas eliminadas (no días hábiles): 79
2025-05-23 09:24:38,897 - INFO - Dataset tras filtrar días hábiles: (2162, 243)
2025-05-23 09:24:38,897 - INFO - Columna target tomada como la última columna: 'PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20'
2025-05-23 09:24:38,900 - INFO - Estadísticas del target 'PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20':
2025-05-23 09:24:38,901 - INFO -   - count: 2142.0
2025-05-23 09:24:38,902 - INFO -   - mean: 0.008263
2025-05-23 09:24:38,902 - INFO -   - std: 0.043894
2025-05-23 09:24:38,904 - INFO -   - min: -0.309455
2025-05-23 09:24:38,905 - INFO -   - 25%: -0.009061
2025-05-23 09:24:38,906 - INFO -   - 50%: 0.014570
2025-05-23 09:24:38,907 - INFO -   - 75%: 0.032831
2025-05-23 09:24:38,908 - INFO -   - max: 0.261822
2025-05-23 09:24:38,911 - INFO - Separación de datos - X: (2162, 242), y: (2162,)
2025-05-23 09:24:38,912 - INFO - Extrayendo 'date' de las features para conservarla aparte.
2025-05-23 09:24:38,915 - INFO - Número de columnas numéricas: 241 de 241 originales
2025-05-23 09:24:38,917 - INFO - Primeras 10 columnas numéricas: ['MoM_PRICE_Australia_10Y_Bond_bond', 'log_diff_PRICE_Australia_10Y_Bond_bond', 'MoM_PRICE_Italy_10Y_Bond_bond', 'log_diff_PRICE_Italy_10Y_Bond_bond', 'rolling_var_PRICE_Italy_10Y_Bond_bond', 'zscore_PRICE_Italy_10Y_Bond_bond', 'MoM_PRICE_Japan_10Y_Bond_bond', 'YoY_PRICE_Japan_10Y_Bond_bond', 'log_diff_PRICE_Japan_10Y_Bond_bond', 'rolling_var_PRICE_Japan_10Y_Bond_bond']
2025-05-23 09:24:38,917 - INFO - ... y 231 más
2025-05-23 09:24:38,919 - INFO - No se aplicó escalado; se mantienen los valores originales.
2025-05-23 09:24:38,926 - INFO - Dimensiones tras eliminar NaNs - X: (2142, 241), y: (2142,)
2025-05-23 09:24:38,930 - INFO - Índices reseteados para asegurar alineación 0..N-1
2025-05-23 09:24:38,931 - INFO - Dimensión de X_scaled antes de FPI: (2142, 241)
2025-05-23 09:24:38,932 - INFO - Dimensión de y antes de FPI: (2142,)
2025-05-23 09:24:38,933 - INFO - Dimensión de date_data antes de FPI: (2142,)
2025-05-23 09:24:38,940 - INFO - Últimas 3 filas de X_scaled:
      MoM_PRICE_Australia_10Y_Bond_bond  \
2139                           0.080056   
2140                           0.026310   
2141                          -0.001555   

      log_diff_PRICE_Australia_10Y_Bond_bond  MoM_PRICE_Italy_10Y_Bond_bond  \
2139                                0.001597                       0.083064   
2140                               -0.020778                       0.050994   
2141                               -0.005445                       0.056571   

      log_diff_PRICE_Italy_10Y_Bond_bond  \
2139                           -0.030449   
2140                           -0.008996   
2141                           -0.001292   

      rolling_var_PRICE_Italy_10Y_Bond_bond  zscore_PRICE_Italy_10Y_Bond_bond  \
2139                               0.014089                          1.105008   
2140                               0.013433                          0.826407   
2141                               0.012211                          0.772788   

      MoM_PRICE_Japan_10Y_Bond_bond  YoY_PRICE_Japan_10Y_Bond_bond  \
2139                       0.182592                       0.721763   
2140                       0.123249                       0.689607   
2141                       0.149425                       0.630435   

      log_diff_PRICE_Japan_10Y_Bond_bond  \
2139                            0.004008   
2140                           -0.021110   
2141                           -0.001363   

      rolling_var_PRICE_Japan_10Y_Bond_bond  ...  \
2139                               0.004175  ...   
2140                               0.004405  ...   
2141                               0.004312  ...   

      ESI_AWCDISA_US_Empire_State_Index_business_confidence  \
2139                                               -2.3       
2140                                               -2.3       
2141                                               -2.3       

      Actual_US_Philly_Fed_Index_business_confidence  \
2139                                           -16.4   
2140                                            44.3   
2141                                            44.3   

      DNKSLRTCR03GPSAM_Denmark_Car_Registrations_MoM  \
2139                                       -8.016086   
2140                                       -8.016086   
2141                                       -8.016086   

      USASLRTCR03GPSAM_US_Car_Registrations_MoM  \
2139                                  -6.910168   
2140                                  -6.910168   
2141                                  -6.910168   

      ZAFSLRTCR03GPSAM_SouthAfrica_Car_Registrations_MoM  \
2139                                          12.427746    
2140                                          12.427746    
2141                                          12.427746    

      GBRSLRTCR03GPSAM_United_Kingdom_Car_Registrations_MoM  \
2139                                          -0.673387       
2140                                          -0.673387       
2141                                          -0.673387       

      CSCICP02CHQ460S_Switzerland_Consumer_Confidence_consumer_confidence  \
2139                                          -31.11702                     
2140                                          -31.11702                     
2141                                          -31.11702                     

      GDP_US_GDP_Growth_economics  ECBDFR_ECB_Deposit_Rate_economics  \
2139                    29977.632                                3.0   
2140                    29977.632                                3.0   
2141                    29977.632                                3.0   

      PRICE_S&P500_Index_index_pricing_Return_Target  
2139                                        0.017153  
2140                                        0.029934  
2141                                        0.019673  

[3 rows x 241 columns]
2025-05-23 09:24:38,941 - INFO - Últimas 3 filas de y:
2139   -0.084632
2140   -0.058881
2141   -0.036629
Name: PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20, dtype: float64
2025-05-23 09:24:38,944 - INFO - Últimas 3 filas de date_data:
2139   2025-01-15
2140   2025-01-16
2141   2025-01-17
Name: date, dtype: datetime64[ns]
2025-05-23 09:24:38,945 - INFO - ============================================================
2025-05-23 09:24:38,945 - INFO - INICIANDO SELECCIÓN DE FEATURES CON FPI
2025-05-23 09:24:38,947 - INFO - ============================================================
2025-05-23 09:24:38,948 - INFO - Número total de features antes de FPI: 241
2025-05-23 09:24:38,948 - INFO - Forecast period: 1MONTH
2025-05-23 09:24:38,949 - INFO - Gap usado para TimeSeriesSplit: 20 días
2025-05-23 09:24:38,950 - INFO - Threshold FPI: 1e-06
2025-05-23 09:24:38,951 - INFO - ==================================================
2025-05-23 09:24:38,952 - INFO - [FPI] INICIANDO ANÁLISIS DE FEATURE PERMUTATION IMPORTANCE
2025-05-23 09:24:38,953 - INFO - ==================================================
2025-05-23 09:24:38,954 - INFO - [FPI] Dimensiones de datos - X: (2142, 241), y: (2142,)
2025-05-23 09:24:38,955 - INFO - [FPI] Rango de valores target - Min: -0.309455, Max: 0.261822, Mean: 0.008263
2025-05-23 09:24:38,956 - INFO - [FPI] Parámetros - CV splits: 5, gap: 20, threshold: 1e-06
2025-05-23 09:24:39,345 - INFO - Gráfico de CV splits guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\plots\cv_splits_20250523_092434.png
2025-05-23 09:24:39,346 - INFO - [FPI] Detalle de los splits de validación cruzada temporal:
2025-05-23 09:24:39,346 - INFO - [FPI] Split 1:
2025-05-23 09:24:39,347 - INFO -   - Train: 337 muestras (índices 0 a 336)
2025-05-23 09:24:39,348 - INFO -   - Validation: 357 muestras (índices 357 a 713)
2025-05-23 09:24:39,348 - INFO -   - Gap efectivo: 20 muestras
2025-05-23 09:24:39,349 - INFO - [FPI] Split 2:
2025-05-23 09:24:39,349 - INFO -   - Train: 694 muestras (índices 0 a 693)
2025-05-23 09:24:39,350 - INFO -   - Validation: 357 muestras (índices 714 a 1070)
2025-05-23 09:24:39,350 - INFO -   - Gap efectivo: 20 muestras
2025-05-23 09:24:39,352 - INFO - [FPI] Split 3:
2025-05-23 09:24:39,355 - INFO -   - Train: 1051 muestras (índices 0 a 1050)
2025-05-23 09:24:39,356 - INFO -   - Validation: 357 muestras (índices 1071 a 1427)
2025-05-23 09:24:39,357 - INFO -   - Gap efectivo: 20 muestras
2025-05-23 09:24:39,358 - INFO - [FPI] Split 4:
2025-05-23 09:24:39,359 - INFO -   - Train: 1408 muestras (índices 0 a 1407)
2025-05-23 09:24:39,360 - INFO -   - Validation: 357 muestras (índices 1428 a 1784)
2025-05-23 09:24:39,361 - INFO -   - Gap efectivo: 20 muestras
2025-05-23 09:24:39,362 - INFO - [FPI] Split 5:
2025-05-23 09:24:39,362 - INFO -   - Train: 1765 muestras (índices 0 a 1764)
2025-05-23 09:24:39,364 - INFO -   - Validation: 357 muestras (índices 1785 a 2141)
2025-05-23 09:24:39,364 - INFO -   - Gap efectivo: 20 muestras
2025-05-23 09:24:39,365 - INFO - [FPI] Configurando CatBoostRegressor con los siguientes parámetros:
2025-05-23 09:24:39,366 - INFO -   - loss_function: RMSE
2025-05-23 09:24:39,367 - INFO -   - eval_metric: RMSE
2025-05-23 09:24:39,368 - INFO -   - early_stopping_rounds: 50
2025-05-23 09:24:39,370 - INFO -   - verbose: 0
2025-05-23 09:24:39,371 - INFO -   - random_seed: 42
2025-05-23 09:24:39,371 - INFO -   - n_estimators: 500
2025-05-23 09:24:39,372 - INFO -   - learning_rate: 0.01
2025-05-23 09:24:39,373 - INFO -   - max_depth: 8
2025-05-23 09:24:39,375 - INFO - [FPI] Configurando SelectByShuffling con threshold=1e-06
2025-05-23 09:24:39,376 - INFO - [FPI] Scorer utilizado: neg_mean_squared_error
2025-05-23 09:24:39,377 - INFO - [FPI] Iniciando proceso de fit con SelectByShuffling...
2025-05-23 09:38:35,160 - INFO - [FPI] Proceso de fit completado en 835.78 segundos
2025-05-23 09:38:35,167 - INFO - [FPI] Se calcularon drift scores para 241 columnas.
2025-05-23 09:38:35,171 - INFO - [FPI] Features seleccionadas por FPI: 37 de 241 (15.4%)
2025-05-23 09:38:35,178 - INFO - [FPI] Top 10 features por importancia (performance drift):
2025-05-23 09:38:35,369 - INFO - [FPI] Bottom 10 features con menor importancia:
2025-05-23 09:38:35,733 - INFO - [FPI] CSV con todos los drift scores guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\plots\fpi_drifts_20250523_092434.csv
2025-05-23 09:38:57,822 - INFO - Gráfico de performance drift guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\plots\performance_drift_20250523_092434.png
2025-05-23 09:38:57,826 - INFO - [FPI] Proceso FPI completado en 858.88 segundos
2025-05-23 09:38:57,829 - INFO - [FPI] Número de features seleccionadas: 37
2025-05-23 09:38:57,835 - INFO - ==================================================
2025-05-23 09:38:57,838 - INFO - Proceso FPI completado en 858.89 segundos
2025-05-23 09:38:57,842 - INFO - Features finales seleccionadas (37/241 = 15.4%):
2025-05-23 09:38:57,845 - INFO -   - Grupo 'zscore': 5 features
2025-05-23 09:38:57,850 - INFO -     ['zscore_PRICE_Italy_10Y_Bond_bond', 'zscore_Actual_China_M2_MoneySupply_YoY_economics', 'zscore_Actual_IPC Colombia_economics', 'zscore_Actual_Eurozone_Unemployment_Rate_unemployment_rate', 'zscore_UNRATE_US_Unemployment_Rate_unemployment_rate']
2025-05-23 09:38:57,857 - INFO -   - Grupo 'YoY': 4 features
2025-05-23 09:38:57,860 - INFO -     ['YoY_PRICE_Japan_10Y_Bond_bond', 'YoY_Actual_U.S. All Car Sales_car_registrations', 'YoY_Actual_US_ConferenceBoard_LEI_leading_economic_index', 'YoY_Actual_IPC Colombia_economics']
2025-05-23 09:38:57,866 - INFO -   - Grupo '3M': 7 features
2025-05-23 09:38:57,872 - INFO -     ['3M_change_PRICE_Japan_10Y_Bond_bond', '3M_change_PRICE_Germany_10Y_Bond_bond', '3M_change_PRICE_CrudeOil_WTI_commodities', '3M_change_Actual_China_M2_MoneySupply_YoY_economics', '3M_change_Actual_Mexico_CPI_MoM_economics']...
2025-05-23 09:38:57,879 - INFO -   - Grupo '6M': 3 features
2025-05-23 09:38:57,890 - INFO -     ['6M_change_PRICE_Japan_10Y_Bond_bond', '6M_change_PRICE_Iron_ore_fines_62%_Fe_CFR_Futures_commodities', '6M_change_Actual_China_Exports_exports']
2025-05-23 09:38:57,925 - INFO -   - Grupo 'momentum': 2 features
2025-05-23 09:38:57,938 - INFO -     ['momentum_PRICE_CrudeOil_WTI_commodities', 'momentum_PRICE_Palladium_Futures_commodities']
2025-05-23 09:38:57,947 - INFO -   - Grupo 'rolling': 3 features
2025-05-23 09:38:57,998 - INFO -     ['rolling_var_PRICE_Copper_Futures_commodities', 'rolling_var_PRICE_Nickel_Futures_commodities', 'rolling_var_PRICE_JPY_USD_Spot_exchange_rate']
2025-05-23 09:38:58,016 - INFO -   - Grupo 'MACD': 3 features
2025-05-23 09:38:58,020 - INFO -     ['MACD_signal_PRICE_Copper_Futures_commodities', 'MACD_signal_PRICE_Nickel_Futures_commodities', 'MACD_signal_PRICE_EUR_GBP_Cross_exchange_rate']
2025-05-23 09:38:58,030 - INFO -   - Grupo 'MoM': 3 features
2025-05-23 09:38:58,043 - INFO -     ['MoM_Actual_China_M2_MoneySupply_YoY_economics', 'MoM_Actual_China_Exports_exports', 'MoM_UNRATE_US_Unemployment_Rate_unemployment_rate']
2025-05-23 09:38:58,064 - INFO -   - Grupo 'log': 3 features
2025-05-23 09:38:58,070 - INFO -     ['log_Actual_Mexico_CPI_MoM_economics', 'log_Actual_Singapore_NonOil_Exports_YoY_economics', 'log_Actual_China_Exports_exports']
2025-05-23 09:38:58,073 - INFO -   - Grupo 'YTD': 1 features
2025-05-23 09:38:58,079 - INFO -     ['YTD_Actual_Mexico_CPI_MoM_economics']
2025-05-23 09:38:58,085 - INFO -   - Grupo 'Actual': 1 features
2025-05-23 09:38:58,099 - INFO -     ['Actual_US_Philly_Fed_Index_business_confidence']
2025-05-23 09:38:58,116 - INFO -   - Grupo 'GBRSLRTCR03GPSAM': 1 features
2025-05-23 09:38:58,126 - INFO -     ['GBRSLRTCR03GPSAM_United_Kingdom_Car_Registrations_MoM']
2025-05-23 09:38:58,134 - INFO -   - Grupo 'PRICE': 1 features
2025-05-23 09:38:58,146 - INFO -     ['PRICE_S&P500_Index_index_pricing_Return_Target']
2025-05-23 09:38:58,157 - INFO - Shape final_X: (2142, 37), y: (2142,)
2025-05-23 09:38:58,168 - INFO - Shape date_data: (2142,)
2025-05-23 09:38:58,174 - INFO - Verificando longitudes antes de concat:
2025-05-23 09:38:58,183 - INFO - Len final_X=2142, Len y=2142, Len date_data=2142
2025-05-23 09:38:58,195 - INFO - Shape final tras la selección de features y concat: (2142, 39)
2025-05-23 09:38:58,202 - INFO - Columnas del DataFrame final: ['date', 'zscore_PRICE_Italy_10Y_Bond_bond', 'YoY_PRICE_Japan_10Y_Bond_bond', '3M_change_PRICE_Japan_10Y_Bond_bond', '6M_change_PRICE_Japan_10Y_Bond_bond', '3M_change_PRICE_Germany_10Y_Bond_bond', 'YoY_Actual_U.S. All Car Sales_car_registrations', 'momentum_PRICE_CrudeOil_WTI_commodities', '3M_change_PRICE_CrudeOil_WTI_commodities', 'rolling_var_PRICE_Copper_Futures_commodities', 'MACD_signal_PRICE_Copper_Futures_commodities', 'momentum_PRICE_Palladium_Futures_commodities', 'rolling_var_PRICE_Nickel_Futures_commodities', 'MACD_signal_PRICE_Nickel_Futures_commodities', '6M_change_PRICE_Iron_ore_fines_62%_Fe_CFR_Futures_commodities', 'MoM_Actual_China_M2_MoneySupply_YoY_economics', '3M_change_Actual_China_M2_MoneySupply_YoY_economics', 'zscore_Actual_China_M2_MoneySupply_YoY_economics', 'log_Actual_Mexico_CPI_MoM_economics', '3M_change_Actual_Mexico_CPI_MoM_economics', 'YTD_Actual_Mexico_CPI_MoM_economics', 'YoY_Actual_US_ConferenceBoard_LEI_leading_economic_index', 'YoY_Actual_IPC Colombia_economics', '3M_change_Actual_IPC Colombia_economics', 'zscore_Actual_IPC Colombia_economics', 'rolling_var_PRICE_JPY_USD_Spot_exchange_rate', 'MACD_signal_PRICE_EUR_GBP_Cross_exchange_rate', 'log_Actual_Singapore_NonOil_Exports_YoY_economics', '3M_change_Actual_Singapore_NonOil_Exports_YoY_economics', 'MoM_Actual_China_Exports_exports', 'log_Actual_China_Exports_exports', '6M_change_Actual_China_Exports_exports', 'zscore_Actual_Eurozone_Unemployment_Rate_unemployment_rate', 'MoM_UNRATE_US_Unemployment_Rate_unemployment_rate', 'zscore_UNRATE_US_Unemployment_Rate_unemployment_rate', 'Actual_US_Philly_Fed_Index_business_confidence', 'GBRSLRTCR03GPSAM_United_Kingdom_Car_Registrations_MoM', 'PRICE_S&P500_Index_index_pricing_Return_Target', 'PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20']
2025-05-23 09:38:58,373 - INFO - Primeras 3 filas del DataFrame final:
        date  zscore_PRICE_Italy_10Y_Bond_bond  YoY_PRICE_Japan_10Y_Bond_bond  \
0 2015-01-30                         -1.312309                      -0.534202   
1 2015-02-02                         -1.309352                      -0.523888   
2 2015-02-03                         -1.409764                      -0.391304   

   3M_change_PRICE_Japan_10Y_Bond_bond  6M_change_PRICE_Japan_10Y_Bond_bond  \
0                            -0.404167                            -0.433663   
1                            -0.374459                            -0.427723   
2                            -0.300000                            -0.274900   

   3M_change_PRICE_Germany_10Y_Bond_bond  \
0                              -0.620606   
1                              -0.625151   
2                              -0.582431   

   YoY_Actual_U.S. All Car Sales_car_registrations  \
0                                         0.120548   
1                                         0.120548   
2                                         0.032877   

   momentum_PRICE_CrudeOil_WTI_commodities  \
0                                    -0.45   
1                                     1.79   
2                                     6.66   

   3M_change_PRICE_CrudeOil_WTI_commodities  \
0                                 -0.386650   
1                                 -0.359561   
2                                 -0.319348   

   rolling_var_PRICE_Copper_Futures_commodities  ...  \
0                                      0.012588  ...   
1                                      0.011843  ...   
2                                      0.010233  ...   

   MoM_Actual_China_Exports_exports  log_Actual_China_Exports_exports  \
0                           1.06383                          0.092579   
1                           1.06383                          0.092579   
2                           1.06383                          0.092579   

   6M_change_Actual_China_Exports_exports  \
0                               -0.331034   
1                               -0.331034   
2                               -0.331034   

   zscore_Actual_Eurozone_Unemployment_Rate_unemployment_rate  \
0                                          -7.616867            
1                                          -5.340100            
2                                          -4.322422            

   MoM_UNRATE_US_Unemployment_Rate_unemployment_rate  \
0                                           0.000000   
1                                          -0.035088   
2                                          -0.035088   

   zscore_UNRATE_US_Unemployment_Rate_unemployment_rate  \
0                                           0.168522      
1                                          -2.234919      
2                                          -2.126207      

   Actual_US_Philly_Fed_Index_business_confidence  \
0                                             6.3   
1                                             6.3   
2                                             6.3   

   GBRSLRTCR03GPSAM_United_Kingdom_Car_Registrations_MoM  \
0                                           0.265793       
1                                          -1.712259       
2                                          -1.712259       

   PRICE_S&P500_Index_index_pricing_Return_Target  \
0                                        0.054887   
1                                        0.047803   
2                                        0.028195   

   PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20  
0                                          -0.020670         
1                                          -0.014735         
2                                          -0.018930         

[3 rows x 39 columns]
2025-05-23 09:38:58,451 - INFO - Últimas 3 filas del DataFrame final:
           date  zscore_PRICE_Italy_10Y_Bond_bond  \
2139 2025-01-15                          1.105008   
2140 2025-01-16                          0.826407   
2141 2025-01-17                          0.772788   

      YoY_PRICE_Japan_10Y_Bond_bond  3M_change_PRICE_Japan_10Y_Bond_bond  \
2139                       0.721763                             0.275510   
2140                       0.689607                             0.253125   
2141                       0.630435                             0.264489   

      6M_change_PRICE_Japan_10Y_Bond_bond  \
2139                             0.178134   
2140                             0.164569   
2141                             0.250000   

      3M_change_PRICE_Germany_10Y_Bond_bond  \
2139                               0.092737   
2140                               0.116748   
2141                               0.092536   

      YoY_Actual_U.S. All Car Sales_car_registrations  \
2139                                        -0.029316   
2140                                        -0.029316   
2141                                        -0.029316   

      momentum_PRICE_CrudeOil_WTI_commodities  \
2139                                     7.46   
2140                                     6.18   
2141                                     4.67   

      3M_change_PRICE_CrudeOil_WTI_commodities  \
2139                                  0.118516   
2140                                  0.126575   
2141                                  0.091521   

      rolling_var_PRICE_Copper_Futures_commodities  ...  \
2139                                      0.014501  ...   
2140                                      0.017862  ...   
2141                                      0.019125  ...   

      MoM_Actual_China_Exports_exports  log_Actual_China_Exports_exports  \
2139                          0.597015                          0.101654   
2140                          0.597015                          0.101654   
2141                          0.597015                          0.101654   

      6M_change_Actual_China_Exports_exports  \
2139                                0.244186   
2140                                0.244186   
2141                                0.244186   

      zscore_Actual_Eurozone_Unemployment_Rate_unemployment_rate  \
2139                                          -0.298988            
2140                                          -0.265025            
2141                                          -0.227496            

      MoM_UNRATE_US_Unemployment_Rate_unemployment_rate  \
2139                                           -0.02439   
2140                                           -0.02439   
2141                                           -0.02439   

      zscore_UNRATE_US_Unemployment_Rate_unemployment_rate  \
2139                                          -1.627094      
2140                                          -1.570135      
2141                                          -1.516931      

      Actual_US_Philly_Fed_Index_business_confidence  \
2139                                           -16.4   
2140                                            44.3   
2141                                            44.3   

      GBRSLRTCR03GPSAM_United_Kingdom_Car_Registrations_MoM  \
2139                                          -0.673387       
2140                                          -0.673387       
2141                                          -0.673387       

      PRICE_S&P500_Index_index_pricing_Return_Target  \
2139                                        0.017153   
2140                                        0.029934   
2141                                        0.019673   

      PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20  
2139                                          -0.084632         
2140                                          -0.058881         
2141                                          -0.036629         

[3 rows x 39 columns]
2025-05-23 09:39:06,879 - INFO - Dataset final guardado en 'C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\3_trainingdata\ULTIMO_S&P500_final_FPI.xlsx' con forma (2142, 39) en 8.40 segundos.
2025-05-23 09:39:06,884 - INFO - Tamaño del archivo: 0.72 MB
2025-05-23 09:39:06,887 - INFO - ============================================================
2025-05-23 09:39:06,891 - INFO - PROCESO COMPLETADO EN 14m 32.71s
2025-05-23 09:39:06,896 - INFO - Features originales: 241
2025-05-23 09:39:06,901 - INFO - Features seleccionadas: 37 (15.4%)
2025-05-23 09:39:06,905 - INFO - Reducción: 204 features (84.6%)
2025-05-23 09:39:06,908 - INFO - Archivo final: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\3_trainingdata\ULTIMO_S&P500_final_FPI.xlsx
2025-05-23 09:39:06,917 - INFO - ============================================================
2025-05-23 09:42:16,061 - INFO - No se detectó ninguna GPU. Usando CPU.
2025-05-23 09:42:16,096 - INFO - Usando el archivo más reciente: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\3_trainingdata\ULTIMO_S&P500_final_FPI.xlsx
2025-05-23 09:42:16,132 - INFO - Usando horizonte de 20 días para forecast_period=1MONTH
2025-05-23 09:42:19,105 - INFO - Datos leídos y ordenados por fecha.
2025-05-23 09:42:19,127 - INFO - Se han imputado los valores NaN e inf (ffill y relleno con 0).
2025-05-23 09:42:19,136 - INFO - Target: 'PRICE_S&P500_Index_index_pricing_Return_Target_lagged_20'
2025-05-23 09:42:19,147 - INFO - Dimensiones: X: (2142, 38), y: (2142,)
2025-05-23 09:42:19,238 - INFO - Tiempo de carga y preprocesamiento: 3.10s
2025-05-23 09:42:19,243 - INFO - Realizando división en tres zonas (70-20-10)
2025-05-23 09:42:19,249 - INFO - División en tres zonas: A (HPO)=1499, B (Back-test)=428, C (Hold-out)=215
2025-05-23 09:42:19,254 - INFO - Tiempo para split de datos: 0.01s
2025-05-23 09:42:19,261 - INFO - === Optimizando y entrenando CatBoost... ===
2025-05-23 09:42:19,264 - INFO - [CatBoost] Paso 1: RandomizedSearchCV en Zona A
2025-05-23 09:42:19,268 - INFO - [CatBoost] ========== Iniciando RandomizedSearchCV ==========
2025-05-23 09:42:19,275 - INFO - [CatBoost] Modo de ejecución detectado: fast
2025-05-23 09:42:19,281 - INFO - [CatBoost] Modo rápido activado: usando 3 trials en lugar de 3
2025-05-23 09:42:19,287 - INFO - [CatBoost] Usando parámetros optimizados para velocidad
2025-05-23 09:42:19,376 - INFO - [CatBoost] Parámetros a optimizar:
2025-05-23 09:42:19,379 - INFO -   - learning_rate: <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x000001EF913EBD40>
2025-05-23 09:42:19,382 - INFO -   - depth: <scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x000001EF92E2D2E0>
2025-05-23 09:42:19,384 - INFO -   - iterations: <scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x000001EF92E2F7A0>
2025-05-23 09:42:19,388 - INFO - [CatBoost] Creando modelo base para RandomizedSearchCV
2025-05-23 09:42:19,391 - INFO - [CatBoost] Configuración de paralelismo: 4 cores
2025-05-23 09:42:19,393 - INFO - [CatBoost] Configurando RandomizedSearchCV...
2025-05-23 09:42:19,411 - INFO - [CatBoost] Tamaño del dataset: 1499 filas, 37 características
2025-05-23 09:42:19,415 - INFO - [CatBoost] CV splits: 3, Gap: 20
2025-05-23 09:42:19,426 - INFO - [CatBoost] Tiempo máximo permitido: 30.0 minutos
2025-05-23 09:42:26,221 - INFO - [CatBoost] ========== Resultados RandomizedSearchCV ==========
2025-05-23 09:42:26,253 - INFO - [CatBoost]   - depth: 6
2025-05-23 09:42:26,257 - INFO - [CatBoost]   - iterations: 121
2025-05-23 09:42:26,266 - INFO - [CatBoost]   - learning_rate: 0.03394633936788147
2025-05-23 09:42:26,338 - INFO - [CatBoost]   - Mejor RMSE: 0.0422 ± 0.0181
2025-05-23 09:42:26,341 - INFO - [CatBoost]   - RMSE promedio: 0.0426
2025-05-23 09:42:26,349 - INFO - [CatBoost]   - RMSE mínimo: 0.0422
2025-05-23 09:42:26,362 - INFO - [CatBoost]   - RMSE máximo: 0.0429
2025-05-23 09:42:26,400 - INFO - [CatBoost] Paso 2: Optuna en Zona A (refinamiento)
2025-05-23 09:42:26,412 - INFO - [CatBoost] Iniciando optimización con 2 trials
2025-05-23 09:42:35,023 - INFO - [CatBoost] Trial 0: RMSE=0.0420, Time=8.61s
2025-05-23 09:42:48,793 - INFO - [CatBoost] Trial 1: RMSE=0.0415, Time=13.76s
2025-05-23 09:42:48,798 - INFO - [CatBoost] Mejor RMSE en CV (Optuna): 0.0415
2025-05-23 09:42:48,799 - INFO - [CatBoost] Mejores hiperparámetros: {'learning_rate': 0.02501111902649229, 'depth': 8, 'iterations': 372}
2025-05-23 09:42:48,800 - INFO - [CatBoost] Paso 3: Back-test en Zona B
2025-05-23 09:42:48,802 - INFO - [CatBoost] Iniciando back-test en Zona B
2025-05-23 09:42:52,163 - INFO - [CatBoost] Back-test completado en 3.36s
2025-05-23 09:42:52,165 - INFO - [CatBoost] Métricas Back-test (Zona B):
2025-05-23 09:42:52,165 - INFO -   - RMSE: 0.0447
2025-05-23 09:42:52,166 - INFO -   - MAE: 0.0372
2025-05-23 09:42:52,167 - INFO -   - R2: 0.0896
2025-05-23 09:42:52,167 - INFO -   - SMAPE: 148.7726
2025-05-23 09:42:52,168 - INFO - [CatBoost] Paso 4: Hold-out en Zona C
2025-05-23 09:42:52,169 - INFO - [CatBoost] Iniciando hold-out final en Zona C
2025-05-23 09:42:55,710 - INFO - [CatBoost] Hold-out completado en 3.54s
2025-05-23 09:42:55,712 - INFO - [CatBoost] Métricas Hold-out (Zona C):
2025-05-23 09:42:55,713 - INFO -   - RMSE: 0.0326
2025-05-23 09:42:55,713 - INFO -   - MAE: 0.0233
2025-05-23 09:42:55,714 - INFO -   - R2: 0.0302
2025-05-23 09:42:55,715 - INFO -   - SMAPE: 113.9095
2025-05-23 09:42:55,715 - INFO - [CatBoost] Paso 5: Modelo final (100% de los datos)
2025-05-23 09:42:59,331 - INFO - [CatBoost] Modelo final guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\models\catboost_best.pkl
2025-05-23 09:42:59,351 - INFO - Historial de hiperparámetros actualizado y guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\hyperparameters_history.csv
2025-05-23 09:42:59,353 - INFO - Generando pronóstico para modelo estándar
2025-05-23 09:42:59,370 - INFO - Pronóstico generado con 20 valores válidos de 20
2025-05-23 09:42:59,399 - INFO - [CatBoost] CSV guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\s&p500_catboost_three_zones.csv
2025-05-23 09:42:59,402 - INFO - [CatBoost] Generando gráficos solo con Zona B, Zona C y Forecast
2025-05-23 09:42:59,402 - INFO - [CatBoost] Datos para gráficos: 663 registros (excluyendo 1499 de Training)
2025-05-23 09:42:59,798 - INFO - [CatBoost] Gráfico principal guardado (sin Zona A): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\catboost_three_zones_eval_test_forecast.png
2025-05-23 09:43:00,327 - INFO - [CatBoost] Gráfico detallado de horizonte guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\catboost_forecast_horizon_detail.png
2025-05-23 09:43:00,866 - INFO - [CatBoost] Gráfico desde 2024 guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\catboost_desde_2024_hasta_forecast.png
2025-05-23 09:43:01,316 - INFO - [CatBoost] Gráfico completo guardado (todas las zonas): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\catboost_three_zones_full.png
2025-05-23 09:43:01,842 - INFO - [CatBoost] Gráfico de importancia guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\catboost_three_zones_importance.png
2025-05-23 09:43:01,846 - INFO - [CatBoost]   - Zona B, C y Forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\catboost_three_zones_eval_test_forecast.png
2025-05-23 09:43:01,846 - INFO - [CatBoost]   - Horizonte detallado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\catboost_forecast_horizon_detail.png
2025-05-23 09:43:01,848 - INFO - [CatBoost]   - Desde 2024 hasta forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\catboost_desde_2024_hasta_forecast.png
2025-05-23 09:43:01,849 - INFO - [CatBoost]   - Histórico completo: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\catboost_three_zones_full.png
2025-05-23 09:43:01,850 - INFO - [CatBoost]   - Feature importance: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\catboost_three_zones_importance.png
2025-05-23 09:43:01,851 - INFO - [CatBoost] Procesamiento completo en 42.59s
2025-05-23 09:43:01,854 - INFO - === Completado CatBoost en 42.59s ===
2025-05-23 09:43:01,855 - INFO - === Optimizando y entrenando LightGBM... ===
2025-05-23 09:43:01,856 - INFO - [LightGBM] Paso 1: RandomizedSearchCV en Zona A
2025-05-23 09:43:01,857 - INFO - [LightGBM] ========== Iniciando RandomizedSearchCV ==========
2025-05-23 09:43:01,858 - INFO - [LightGBM] Modo de ejecución detectado: fast
2025-05-23 09:43:01,859 - INFO - [LightGBM] Modo rápido activado: usando 3 trials en lugar de 3
2025-05-23 09:43:01,860 - INFO - [LightGBM] Usando parámetros optimizados para velocidad
2025-05-23 09:43:01,874 - INFO - [LightGBM] Parámetros a optimizar:
2025-05-23 09:43:01,875 - INFO -   - learning_rate: <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x000001EF930BE1B0>
2025-05-23 09:43:01,876 - INFO -   - max_depth: <scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x000001EF8DF028D0>
2025-05-23 09:43:01,877 - INFO -   - n_estimators: <scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x000001EF9306E270>
2025-05-23 09:43:01,878 - INFO -   - subsample: <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x000001EF9306EB10>
2025-05-23 09:43:01,879 - INFO - [LightGBM] Creando modelo base para RandomizedSearchCV
2025-05-23 09:43:01,881 - INFO - [LightGBM] Configuración de paralelismo: 4 cores
2025-05-23 09:43:01,881 - INFO - [LightGBM] Configurando RandomizedSearchCV...
2025-05-23 09:43:01,886 - INFO - [LightGBM] Tamaño del dataset: 1499 filas, 37 características
2025-05-23 09:43:01,886 - INFO - [LightGBM] CV splits: 3, Gap: 20
2025-05-23 09:43:01,888 - INFO - [LightGBM] Tiempo máximo permitido: 30.0 minutos
2025-05-23 09:43:02,742 - INFO - [LightGBM] ========== Resultados RandomizedSearchCV ==========
2025-05-23 09:43:02,751 - INFO - [LightGBM]   - learning_rate: 0.0249816047538945
2025-05-23 09:43:02,752 - INFO - [LightGBM]   - max_depth: 4
2025-05-23 09:43:02,753 - INFO - [LightGBM]   - n_estimators: 64
2025-05-23 09:43:02,753 - INFO - [LightGBM]   - subsample: 0.9195981825434215
2025-05-23 09:43:02,758 - INFO - [LightGBM]   - Mejor RMSE: 0.0461 ± 0.0170
2025-05-23 09:43:02,760 - INFO - [LightGBM]   - RMSE promedio: 0.0481
2025-05-23 09:43:02,761 - INFO - [LightGBM]   - RMSE mínimo: 0.0461
2025-05-23 09:43:02,762 - INFO - [LightGBM]   - RMSE máximo: 0.0497
2025-05-23 09:43:02,770 - INFO - [LightGBM] Paso 2: Optuna en Zona A (refinamiento)
2025-05-23 09:43:02,773 - INFO - [LightGBM] Iniciando optimización con 2 trials
2025-05-23 09:43:02,938 - INFO - [LightGBM] Trial 0: RMSE=0.0430, Time=0.16s
2025-05-23 09:43:03,182 - INFO - [LightGBM] Trial 1: RMSE=0.0428, Time=0.24s
2025-05-23 09:43:03,185 - INFO - [LightGBM] Mejor RMSE en CV (Optuna): 0.0428
2025-05-23 09:43:03,186 - INFO - [LightGBM] Mejores hiperparámetros: {'learning_rate': 0.04160288184576561, 'max_depth': 5, 'n_estimators': 362, 'subsample': 0.9306277020440842}
2025-05-23 09:43:03,187 - INFO - [LightGBM] Paso 3: Back-test en Zona B
2025-05-23 09:43:03,188 - INFO - [LightGBM] Iniciando back-test en Zona B
2025-05-23 09:43:03,317 - INFO - [LightGBM] Back-test completado en 0.13s
2025-05-23 09:43:03,318 - INFO - [LightGBM] Métricas Back-test (Zona B):
2025-05-23 09:43:03,319 - INFO -   - RMSE: 0.0660
2025-05-23 09:43:03,320 - INFO -   - MAE: 0.0521
2025-05-23 09:43:03,320 - INFO -   - R2: -0.9858
2025-05-23 09:43:03,321 - INFO -   - SMAPE: 146.2658
2025-05-23 09:43:03,322 - INFO - [LightGBM] Paso 4: Hold-out en Zona C
2025-05-23 09:43:03,323 - INFO - [LightGBM] Iniciando hold-out final en Zona C
2025-05-23 09:43:03,497 - INFO - [LightGBM] Hold-out completado en 0.17s
2025-05-23 09:43:03,498 - INFO - [LightGBM] Métricas Hold-out (Zona C):
2025-05-23 09:43:03,500 - INFO -   - RMSE: 0.0345
2025-05-23 09:43:03,500 - INFO -   - MAE: 0.0248
2025-05-23 09:43:03,501 - INFO -   - R2: -0.0856
2025-05-23 09:43:03,502 - INFO -   - SMAPE: 125.2435
2025-05-23 09:43:03,503 - INFO - [LightGBM] Paso 5: Modelo final (100% de los datos)
2025-05-23 09:43:03,645 - INFO - [LightGBM] Modelo final guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\models\lightgbm_best.pkl
2025-05-23 09:43:03,665 - INFO - Historial de hiperparámetros actualizado y guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\hyperparameters_history.csv
2025-05-23 09:43:03,666 - INFO - Generando pronóstico para modelo estándar
2025-05-23 09:43:03,708 - INFO - Pronóstico generado con 20 valores válidos de 20
2025-05-23 09:43:03,745 - INFO - [LightGBM] CSV guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\s&p500_lightgbm_three_zones.csv
2025-05-23 09:43:03,748 - INFO - [LightGBM] Generando gráficos solo con Zona B, Zona C y Forecast
2025-05-23 09:43:03,749 - INFO - [LightGBM] Datos para gráficos: 663 registros (excluyendo 1499 de Training)
2025-05-23 09:43:04,149 - INFO - [LightGBM] Gráfico principal guardado (sin Zona A): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lightgbm_three_zones_eval_test_forecast.png
2025-05-23 09:43:04,575 - INFO - [LightGBM] Gráfico detallado de horizonte guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lightgbm_forecast_horizon_detail.png
2025-05-23 09:43:05,142 - INFO - [LightGBM] Gráfico desde 2024 guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lightgbm_desde_2024_hasta_forecast.png
2025-05-23 09:43:05,510 - INFO - [LightGBM] Gráfico completo guardado (todas las zonas): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lightgbm_three_zones_full.png
2025-05-23 09:43:05,949 - INFO - [LightGBM] Gráfico de importancia guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lightgbm_three_zones_importance.png
2025-05-23 09:43:05,952 - INFO - [LightGBM]   - Zona B, C y Forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lightgbm_three_zones_eval_test_forecast.png
2025-05-23 09:43:05,953 - INFO - [LightGBM]   - Horizonte detallado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lightgbm_forecast_horizon_detail.png
2025-05-23 09:43:05,954 - INFO - [LightGBM]   - Desde 2024 hasta forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lightgbm_desde_2024_hasta_forecast.png
2025-05-23 09:43:05,955 - INFO - [LightGBM]   - Histórico completo: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lightgbm_three_zones_full.png
2025-05-23 09:43:05,956 - INFO - [LightGBM]   - Feature importance: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lightgbm_three_zones_importance.png
2025-05-23 09:43:05,956 - INFO - [LightGBM] Procesamiento completo en 4.10s
2025-05-23 09:43:05,958 - INFO - === Completado LightGBM en 4.10s ===
2025-05-23 09:43:05,959 - INFO - === Optimizando y entrenando XGBoost... ===
2025-05-23 09:43:05,960 - INFO - [XGBoost] Paso 1: RandomizedSearchCV en Zona A
2025-05-23 09:43:05,960 - INFO - [XGBoost] ========== Iniciando RandomizedSearchCV ==========
2025-05-23 09:43:05,961 - INFO - [XGBoost] Modo de ejecución detectado: fast
2025-05-23 09:43:05,962 - INFO - [XGBoost] Modo rápido activado: usando 3 trials en lugar de 3
2025-05-23 09:43:05,963 - INFO - [XGBoost] Usando parámetros optimizados para velocidad
2025-05-23 09:43:05,973 - INFO - [XGBoost] Parámetros a optimizar:
2025-05-23 09:43:05,975 - INFO -   - learning_rate: <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x000001EF94E401A0>
2025-05-23 09:43:05,976 - INFO -   - max_depth: <scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x000001EF92F0F1A0>
2025-05-23 09:43:05,976 - INFO -   - n_estimators: <scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x000001EF94E581D0>
2025-05-23 09:43:05,977 - INFO -   - subsample: <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x000001EF92F077A0>
2025-05-23 09:43:05,978 - INFO - [XGBoost] Creando modelo base para RandomizedSearchCV
2025-05-23 09:43:05,978 - INFO - [XGBoost] Configuración de paralelismo: 4 cores
2025-05-23 09:43:05,979 - INFO - [XGBoost] Configurando RandomizedSearchCV...
2025-05-23 09:43:05,983 - INFO - [XGBoost] Tamaño del dataset: 1499 filas, 37 características
2025-05-23 09:43:05,984 - INFO - [XGBoost] CV splits: 3, Gap: 20
2025-05-23 09:43:05,984 - INFO - [XGBoost] Tiempo máximo permitido: 30.0 minutos
2025-05-23 09:43:07,065 - INFO - [XGBoost] ========== Resultados RandomizedSearchCV ==========
2025-05-23 09:43:07,069 - INFO - [XGBoost]   - learning_rate: 0.0249816047538945
2025-05-23 09:43:07,070 - INFO - [XGBoost]   - max_depth: 4
2025-05-23 09:43:07,071 - INFO - [XGBoost]   - n_estimators: 64
2025-05-23 09:43:07,071 - INFO - [XGBoost]   - subsample: 0.9195981825434215
2025-05-23 09:43:07,074 - INFO - [XGBoost]   - Mejor RMSE: 0.0452 ± 0.0177
2025-05-23 09:43:07,075 - INFO - [XGBoost]   - RMSE promedio: 0.0462
2025-05-23 09:43:07,076 - INFO - [XGBoost]   - RMSE mínimo: 0.0452
2025-05-23 09:43:07,076 - INFO - [XGBoost]   - RMSE máximo: 0.0471
2025-05-23 09:43:07,083 - INFO - [XGBoost] Paso 2: Optuna en Zona A (refinamiento)
2025-05-23 09:43:07,084 - INFO - [XGBoost] Iniciando optimización con 2 trials
2025-05-23 09:43:07,574 - INFO - [XGBoost] Trial 0: RMSE=0.0426, Time=0.49s
2025-05-23 09:43:07,885 - INFO - [XGBoost] Trial 1: RMSE=0.0428, Time=0.31s
2025-05-23 09:43:07,888 - INFO - [XGBoost] Mejor RMSE en CV (Optuna): 0.0426
2025-05-23 09:43:07,889 - INFO - [XGBoost] Mejores hiperparámetros: {'learning_rate': 0.04428090942424903, 'max_depth': 4, 'n_estimators': 306, 'subsample': 0.8617516356152757}
2025-05-23 09:43:07,890 - INFO - [XGBoost] Paso 3: Back-test en Zona B
2025-05-23 09:43:07,890 - INFO - [XGBoost] Iniciando back-test en Zona B
2025-05-23 09:43:08,151 - INFO - [XGBoost] Back-test completado en 0.26s
2025-05-23 09:43:08,152 - INFO - [XGBoost] Métricas Back-test (Zona B):
2025-05-23 09:43:08,153 - INFO -   - RMSE: 0.0550
2025-05-23 09:43:08,154 - INFO -   - MAE: 0.0475
2025-05-23 09:43:08,155 - INFO -   - R2: -0.3830
2025-05-23 09:43:08,156 - INFO -   - SMAPE: 159.1830
2025-05-23 09:43:08,157 - INFO - [XGBoost] Paso 4: Hold-out en Zona C
2025-05-23 09:43:08,158 - INFO - [XGBoost] Iniciando hold-out final en Zona C
2025-05-23 09:43:08,469 - INFO - [XGBoost] Hold-out completado en 0.31s
2025-05-23 09:43:08,470 - INFO - [XGBoost] Métricas Hold-out (Zona C):
2025-05-23 09:43:08,471 - INFO -   - RMSE: 0.0335
2025-05-23 09:43:08,472 - INFO -   - MAE: 0.0236
2025-05-23 09:43:08,473 - INFO -   - R2: -0.0227
2025-05-23 09:43:08,474 - INFO -   - SMAPE: 113.6523
2025-05-23 09:43:08,475 - INFO - [XGBoost] Paso 5: Modelo final (100% de los datos)
2025-05-23 09:43:08,757 - INFO - [XGBoost] Modelo final guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\models\xgboost_best.pkl
2025-05-23 09:43:08,778 - INFO - Historial de hiperparámetros actualizado y guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\hyperparameters_history.csv
2025-05-23 09:43:08,779 - INFO - Generando pronóstico para modelo estándar
2025-05-23 09:43:08,787 - INFO - Pronóstico generado con 20 valores válidos de 20
2025-05-23 09:43:08,825 - INFO - [XGBoost] CSV guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\s&p500_xgboost_three_zones.csv
2025-05-23 09:43:08,827 - INFO - [XGBoost] Generando gráficos solo con Zona B, Zona C y Forecast
2025-05-23 09:43:08,828 - INFO - [XGBoost] Datos para gráficos: 663 registros (excluyendo 1499 de Training)
2025-05-23 09:43:09,233 - INFO - [XGBoost] Gráfico principal guardado (sin Zona A): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\xgboost_three_zones_eval_test_forecast.png
2025-05-23 09:43:09,728 - INFO - [XGBoost] Gráfico detallado de horizonte guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\xgboost_forecast_horizon_detail.png
2025-05-23 09:43:10,293 - INFO - [XGBoost] Gráfico desde 2024 guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\xgboost_desde_2024_hasta_forecast.png
2025-05-23 09:43:10,651 - INFO - [XGBoost] Gráfico completo guardado (todas las zonas): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\xgboost_three_zones_full.png
2025-05-23 09:43:11,059 - INFO - [XGBoost] Gráfico de importancia guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\xgboost_three_zones_importance.png
2025-05-23 09:43:11,062 - INFO - [XGBoost]   - Zona B, C y Forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\xgboost_three_zones_eval_test_forecast.png
2025-05-23 09:43:11,063 - INFO - [XGBoost]   - Horizonte detallado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\xgboost_forecast_horizon_detail.png
2025-05-23 09:43:11,064 - INFO - [XGBoost]   - Desde 2024 hasta forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\xgboost_desde_2024_hasta_forecast.png
2025-05-23 09:43:11,065 - INFO - [XGBoost]   - Histórico completo: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\xgboost_three_zones_full.png
2025-05-23 09:43:11,066 - INFO - [XGBoost]   - Feature importance: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\xgboost_three_zones_importance.png
2025-05-23 09:43:11,066 - INFO - [XGBoost] Procesamiento completo en 5.11s
2025-05-23 09:43:11,068 - INFO - === Completado XGBoost en 5.11s ===
2025-05-23 09:43:11,069 - INFO - === Optimizando y entrenando MLP... ===
2025-05-23 09:43:11,069 - INFO - [MLP] Paso 1: RandomizedSearchCV en Zona A
2025-05-23 09:43:11,070 - INFO - [MLP] ========== Iniciando RandomizedSearchCV ==========
2025-05-23 09:43:11,071 - INFO - [MLP] Modo de ejecución detectado: fast
2025-05-23 09:43:11,072 - INFO - [MLP] Modo rápido activado: usando 3 trials en lugar de 3
2025-05-23 09:43:11,073 - INFO - [MLP] Usando parámetros optimizados para velocidad
2025-05-23 09:43:11,083 - INFO - [MLP] Parámetros a optimizar:
2025-05-23 09:43:11,083 - INFO -   - hidden_neurons: <scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x000001EF959F3890>
2025-05-23 09:43:11,084 - INFO -   - learning_rate_init: <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x000001EF959F3D40>
2025-05-23 09:43:11,084 - INFO -   - max_iter: <scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x000001EF92BDEAB0>
2025-05-23 09:43:11,085 - INFO - [MLP] Creando modelo base para RandomizedSearchCV
2025-05-23 09:43:11,086 - INFO - [MLP] Configuración de paralelismo: 4 cores
2025-05-23 09:43:11,087 - INFO - [MLP] Configurando RandomizedSearchCV...
2025-05-23 09:43:11,091 - INFO - [MLP] Tamaño del dataset: 1499 filas, 37 características
2025-05-23 09:43:11,091 - INFO - [MLP] CV splits: 3, Gap: 20
2025-05-23 09:43:11,091 - INFO - [MLP] Tiempo máximo permitido: 30.0 minutos
2025-05-23 09:43:11,337 - ERROR - [MLP] Traceback: 
joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\joblib\externals\loky\process_executor.py", line 463, in _process_worker
    r = call_item()
        ^^^^^^^^^^^
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\joblib\externals\loky\process_executor.py", line 291, in __call__
    return self.fn(*self.args, **self.kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\joblib\parallel.py", line 598, in __call__
    return [func(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\sklearn\utils\parallel.py", line 139, in __call__
    return self.function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\sklearn\model_selection\_validation.py", line 854, in _fit_and_score
    estimator = estimator.set_params(**clone(parameters, safe=False))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\sklearn\base.py", line 283, in set_params
    raise ValueError(
ValueError: Invalid parameter 'hidden_neurons' for estimator MLPRegressor(random_state=42). Valid parameters are: ['activation', 'alpha', 'batch_size', 'beta_1', 'beta_2', 'early_stopping', 'epsilon', 'hidden_layer_sizes', 'learning_rate', 'learning_rate_init', 'max_fun', 'max_iter', 'momentum', 'n_iter_no_change', 'nesterovs_momentum', 'power_t', 'random_state', 'shuffle', 'solver', 'tol', 'validation_fraction', 'verbose', 'warm_start'].
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\pipelines\ml\step_7_0_train_models.py", line 803, in run_randomized_search
    search.fit(X, y)
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\sklearn\model_selection\_search.py", line 1951, in _run_search
    evaluate_candidates(
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\sklearn\model_selection\_search.py", line 970, in evaluate_candidates
    out = parallel(
          ^^^^^^^^^
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\sklearn\utils\parallel.py", line 77, in __call__
    return super().__call__(iterable_with_config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\joblib\parallel.py", line 2007, in __call__
    return output if self.return_generator else list(output)
                                                ^^^^^^^^^^^^
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\joblib\parallel.py", line 1650, in _get_outputs
    yield from self._retrieve()
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\joblib\parallel.py", line 1754, in _retrieve
    self._raise_error_fast()
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\joblib\parallel.py", line 1789, in _raise_error_fast
    error_job.get_result(self.timeout)
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\joblib\parallel.py", line 745, in get_result
    return self._return_or_raise()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\joblib\parallel.py", line 763, in _return_or_raise
    raise self._result
ValueError: Invalid parameter 'hidden_neurons' for estimator MLPRegressor(random_state=42). Valid parameters are: ['activation', 'alpha', 'batch_size', 'beta_1', 'beta_2', 'early_stopping', 'epsilon', 'hidden_layer_sizes', 'learning_rate', 'learning_rate_init', 'max_fun', 'max_iter', 'momentum', 'n_iter_no_change', 'nesterovs_momentum', 'power_t', 'random_state', 'shuffle', 'solver', 'tol', 'validation_fraction', 'verbose', 'warm_start'].
2025-05-23 09:43:11,346 - INFO - [MLP]   - hidden_neurons: 100
2025-05-23 09:43:11,347 - INFO - [MLP]   - learning_rate_init: 0.001
2025-05-23 09:43:11,348 - INFO - [MLP]   - max_iter: 100
2025-05-23 09:43:11,348 - INFO - [MLP] Paso 2: Optuna en Zona A (refinamiento)
2025-05-23 09:43:11,350 - INFO - [MLP] Iniciando optimización con 2 trials
2025-05-23 09:43:20,267 - INFO - [MLP] Trial 0: RMSE=0.2000, Time=8.92s
2025-05-23 09:43:24,100 - INFO - [MLP] Trial 1: RMSE=0.2285, Time=3.83s
2025-05-23 09:43:24,102 - INFO - [MLP] Mejor RMSE en CV (Optuna): 0.2000
2025-05-23 09:43:24,102 - INFO - [MLP] Mejores hiperparámetros: {'hidden_neurons': 124, 'learning_rate_init': 0.0008808391909977486, 'max_iter': 228}
2025-05-23 09:43:24,104 - INFO - [MLP] Paso 3: Back-test en Zona B
2025-05-23 09:43:24,104 - INFO - [MLP] Iniciando back-test en Zona B
2025-05-23 09:43:24,634 - INFO - [MLP] Back-test completado en 0.53s
2025-05-23 09:43:24,635 - INFO - [MLP] Métricas Back-test (Zona B):
2025-05-23 09:43:24,635 - INFO -   - RMSE: 6.5003
2025-05-23 09:43:24,636 - INFO -   - MAE: 1.7030
2025-05-23 09:43:24,637 - INFO -   - R2: -19287.8278
2025-05-23 09:43:24,638 - INFO -   - SMAPE: 157.9857
2025-05-23 09:43:24,639 - INFO - [MLP] Paso 4: Hold-out en Zona C
2025-05-23 09:43:24,640 - INFO - [MLP] Iniciando hold-out final en Zona C
2025-05-23 09:43:25,338 - INFO - [MLP] Hold-out completado en 0.70s
2025-05-23 09:43:25,339 - INFO - [MLP] Métricas Hold-out (Zona C):
2025-05-23 09:43:25,339 - INFO -   - RMSE: 0.2018
2025-05-23 09:43:25,340 - INFO -   - MAE: 0.1487
2025-05-23 09:43:25,341 - INFO -   - R2: -36.1288
2025-05-23 09:43:25,342 - INFO -   - SMAPE: 170.3095
2025-05-23 09:43:25,342 - INFO - [MLP] Paso 5: Modelo final (100% de los datos)
2025-05-23 09:43:26,113 - INFO - [MLP] Modelo final guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\models\mlp_best.pkl
2025-05-23 09:43:26,143 - INFO - Historial de hiperparámetros actualizado y guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\hyperparameters_history.csv
2025-05-23 09:43:26,145 - INFO - Generando pronóstico para modelo estándar
2025-05-23 09:43:26,150 - INFO - Pronóstico generado con 20 valores válidos de 20
2025-05-23 09:43:26,181 - INFO - [MLP] CSV guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\s&p500_mlp_three_zones.csv
2025-05-23 09:43:26,184 - INFO - [MLP] Generando gráficos solo con Zona B, Zona C y Forecast
2025-05-23 09:43:26,184 - INFO - [MLP] Datos para gráficos: 663 registros (excluyendo 1499 de Training)
2025-05-23 09:43:26,526 - INFO - [MLP] Gráfico principal guardado (sin Zona A): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\mlp_three_zones_eval_test_forecast.png
2025-05-23 09:43:27,002 - INFO - [MLP] Gráfico detallado de horizonte guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\mlp_forecast_horizon_detail.png
2025-05-23 09:43:27,594 - INFO - [MLP] Gráfico desde 2024 guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\mlp_desde_2024_hasta_forecast.png
2025-05-23 09:43:27,961 - INFO - [MLP] Gráfico completo guardado (todas las zonas): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\mlp_three_zones_full.png
2025-05-23 09:43:27,967 - INFO - [MLP]   - Zona B, C y Forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\mlp_three_zones_eval_test_forecast.png
2025-05-23 09:43:27,967 - INFO - [MLP]   - Horizonte detallado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\mlp_forecast_horizon_detail.png
2025-05-23 09:43:27,968 - INFO - [MLP]   - Desde 2024 hasta forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\mlp_desde_2024_hasta_forecast.png
2025-05-23 09:43:27,969 - INFO - [MLP]   - Histórico completo: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\mlp_three_zones_full.png
2025-05-23 09:43:27,970 - INFO - [MLP] Procesamiento completo en 16.90s
2025-05-23 09:43:27,971 - INFO - === Completado MLP en 16.90s ===
2025-05-23 09:43:27,972 - INFO - === Optimizando y entrenando SVM... ===
2025-05-23 09:43:27,972 - INFO - [SVM] Paso 1: RandomizedSearchCV en Zona A
2025-05-23 09:43:27,973 - INFO - [SVM] ========== Iniciando RandomizedSearchCV ==========
2025-05-23 09:43:27,973 - INFO - [SVM] Modo de ejecución detectado: fast
2025-05-23 09:43:27,974 - INFO - [SVM] Modo rápido activado: usando 3 trials en lugar de 3
2025-05-23 09:43:27,975 - INFO - [SVM] Usando parámetros optimizados para velocidad
2025-05-23 09:43:27,985 - INFO - [SVM] Parámetros a optimizar:
2025-05-23 09:43:27,986 - INFO -   - C: <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x000001EF94E8D190>
2025-05-23 09:43:27,987 - INFO -   - epsilon: <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x000001EF959F2750>
2025-05-23 09:43:27,988 - INFO - [SVM] Creando modelo base para RandomizedSearchCV
2025-05-23 09:43:27,988 - INFO - [SVM] Configuración de paralelismo: 4 cores
2025-05-23 09:43:27,989 - INFO - [SVM] Configurando RandomizedSearchCV...
2025-05-23 09:43:27,993 - INFO - [SVM] Tamaño del dataset: 1499 filas, 37 características
2025-05-23 09:43:27,993 - INFO - [SVM] CV splits: 3, Gap: 20
2025-05-23 09:43:27,994 - INFO - [SVM] Tiempo máximo permitido: 30.0 minutos
2025-05-23 09:43:29,782 - INFO - [SVM] ========== Resultados RandomizedSearchCV ==========
2025-05-23 09:43:29,791 - INFO - [SVM]   - C: 1.2020838819909643
2025-05-23 09:43:29,792 - INFO - [SVM]   - epsilon: 0.07339917805043039
2025-05-23 09:43:29,797 - INFO - [SVM]   - Mejor RMSE: 0.0513 ± 0.0175
2025-05-23 09:43:29,798 - INFO - [SVM]   - RMSE promedio: 0.0599
2025-05-23 09:43:29,799 - INFO - [SVM]   - RMSE mínimo: 0.0513
2025-05-23 09:43:29,800 - INFO - [SVM]   - RMSE máximo: 0.0662
2025-05-23 09:43:29,808 - INFO - [SVM] Paso 2: Optuna en Zona A (refinamiento)
2025-05-23 09:43:29,810 - INFO - [SVM] Iniciando optimización con 2 trials
2025-05-23 09:43:29,821 - INFO - [SVM] Trial 0: RMSE=0.0612, Time=0.01s
2025-05-23 09:43:29,836 - INFO - [SVM] Trial 1: RMSE=0.0525, Time=0.01s
2025-05-23 09:43:29,838 - INFO - [SVM] Mejor RMSE en CV (Optuna): 0.0525
2025-05-23 09:43:29,839 - INFO - [SVM] Mejores hiperparámetros: {'C': 0.6018782610033143, 'epsilon': 0.07830314311932098}
2025-05-23 09:43:29,840 - INFO - [SVM] Paso 3: Back-test en Zona B
2025-05-23 09:43:29,840 - INFO - [SVM] Iniciando back-test en Zona B
2025-05-23 09:43:29,849 - INFO - [SVM] Back-test completado en 0.01s
2025-05-23 09:43:29,850 - INFO - [SVM] Métricas Back-test (Zona B):
2025-05-23 09:43:29,851 - INFO -   - RMSE: 0.0495
2025-05-23 09:43:29,851 - INFO -   - MAE: 0.0435
2025-05-23 09:43:29,852 - INFO -   - R2: -0.1164
2025-05-23 09:43:29,853 - INFO -   - SMAPE: 173.3494
2025-05-23 09:43:29,854 - INFO - [SVM] Paso 4: Hold-out en Zona C
2025-05-23 09:43:29,855 - INFO - [SVM] Iniciando hold-out final en Zona C
2025-05-23 09:43:29,865 - INFO - [SVM] Hold-out completado en 0.01s
2025-05-23 09:43:29,866 - INFO - [SVM] Métricas Hold-out (Zona C):
2025-05-23 09:43:29,867 - INFO -   - RMSE: 0.0356
2025-05-23 09:43:29,867 - INFO -   - MAE: 0.0292
2025-05-23 09:43:29,868 - INFO -   - R2: -0.1561
2025-05-23 09:43:29,869 - INFO -   - SMAPE: 142.9663
2025-05-23 09:43:29,870 - INFO - [SVM] Paso 5: Modelo final (100% de los datos)
2025-05-23 09:43:29,880 - INFO - [SVM] Modelo final guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\models\svm_best.pkl
2025-05-23 09:43:29,912 - INFO - Historial de hiperparámetros actualizado y guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\hyperparameters_history.csv
2025-05-23 09:43:29,914 - INFO - Generando pronóstico para modelo estándar
2025-05-23 09:43:29,932 - INFO - Pronóstico generado con 20 valores válidos de 20
2025-05-23 09:43:29,984 - INFO - [SVM] CSV guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\s&p500_svm_three_zones.csv
2025-05-23 09:43:29,986 - INFO - [SVM] Generando gráficos solo con Zona B, Zona C y Forecast
2025-05-23 09:43:29,987 - INFO - [SVM] Datos para gráficos: 663 registros (excluyendo 1499 de Training)
2025-05-23 09:43:30,335 - INFO - [SVM] Gráfico principal guardado (sin Zona A): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\svm_three_zones_eval_test_forecast.png
2025-05-23 09:43:30,788 - INFO - [SVM] Gráfico detallado de horizonte guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\svm_forecast_horizon_detail.png
2025-05-23 09:43:31,329 - INFO - [SVM] Gráfico desde 2024 guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\svm_desde_2024_hasta_forecast.png
2025-05-23 09:43:31,660 - INFO - [SVM] Gráfico completo guardado (todas las zonas): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\svm_three_zones_full.png
2025-05-23 09:43:31,664 - INFO - [SVM]   - Zona B, C y Forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\svm_three_zones_eval_test_forecast.png
2025-05-23 09:43:31,665 - INFO - [SVM]   - Horizonte detallado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\svm_forecast_horizon_detail.png
2025-05-23 09:43:31,666 - INFO - [SVM]   - Desde 2024 hasta forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\svm_desde_2024_hasta_forecast.png
2025-05-23 09:43:31,666 - INFO - [SVM]   - Histórico completo: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\svm_three_zones_full.png
2025-05-23 09:43:31,667 - INFO - [SVM] Procesamiento completo en 3.70s
2025-05-23 09:43:31,668 - INFO - === Completado SVM en 3.70s ===
2025-05-23 09:43:31,669 - INFO - === Optimizando y entrenando LSTM... ===
2025-05-23 09:43:31,669 - INFO - [LSTM] Paso 1: RandomizedSearchCV en Zona A
2025-05-23 09:43:31,670 - INFO - [LSTM] ========== Iniciando RandomizedSearchCV ==========
2025-05-23 09:43:31,670 - INFO - [LSTM] Modo de ejecución detectado: fast
2025-05-23 09:43:31,671 - INFO - [LSTM] Modo rápido activado: usando 3 trials en lugar de 3
2025-05-23 09:43:31,672 - INFO - [LSTM] Usando parámetros optimizados para velocidad
2025-05-23 09:43:31,680 - INFO - [LSTM] Parámetros a optimizar:
2025-05-23 09:43:31,681 - INFO -   - units: <scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x000001EF95A16780>
2025-05-23 09:43:31,682 - INFO -   - learning_rate: <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x000001EFA87BC5F0>
2025-05-23 09:43:31,683 - INFO -   - dropout_rate: <scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x000001EF95A39AC0>
2025-05-23 09:43:31,683 - INFO -   - sequence_length: <scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x000001EFA97CF8F0>
2025-05-23 09:43:31,684 - INFO - [LSTM] Generando parámetros iniciales aleatorios para LSTM
2025-05-23 09:43:31,685 - INFO - [LSTM] Parámetros iniciales generados:
2025-05-23 09:43:31,686 - INFO -   - units: 50
2025-05-23 09:43:31,686 - INFO -   - learning_rate: 0.001899774242362026
2025-05-23 09:43:31,687 - INFO -   - dropout_rate: 0.23777466758976015
2025-05-23 09:43:31,687 - INFO -   - sequence_length: 9
2025-05-23 09:43:31,688 - INFO - [LSTM] Paso 2: Optuna en Zona A (refinamiento)
2025-05-23 09:43:31,689 - INFO - [LSTM] Iniciando optimización con 2 trials
2025-05-23 09:43:45,354 - WARNING - From c:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\venv_MValores\Lib\site-packages\keras\src\backend\common\global_state.py:82: The name tf.reset_default_graph is deprecated. Please use tf.compat.v1.reset_default_graph instead.

2025-05-23 09:44:29,932 - INFO - [LSTM] Mejor RMSE en CV (Optuna): 0.1643
2025-05-23 09:44:29,933 - INFO - [LSTM] Mejores hiperparámetros: {'units': 19, 'learning_rate': 0.0013609858243124374, 'dropout_rate': 0.14224625979576414, 'sequence_length': 7}
2025-05-23 09:44:29,934 - INFO - [LSTM] Paso 3: Back-test en Zona B
2025-05-23 09:44:29,935 - INFO - [LSTM] Iniciando back-test en Zona B
2025-05-23 09:44:47,721 - INFO - [LSTM] Back-test completado en 17.79s
2025-05-23 09:44:47,723 - INFO - [LSTM] Métricas Back-test (Zona B):
2025-05-23 09:44:47,724 - INFO -   - RMSE: 0.0724
2025-05-23 09:44:47,725 - INFO -   - MAE: 0.0586
2025-05-23 09:44:47,725 - INFO -   - R2: -1.3934
2025-05-23 09:44:47,726 - INFO -   - SMAPE: 145.9435
2025-05-23 09:44:47,727 - INFO - [LSTM] Paso 4: Hold-out en Zona C
2025-05-23 09:44:47,728 - INFO - [LSTM] Iniciando hold-out final en Zona C
2025-05-23 09:44:56,604 - INFO - [LSTM] Hold-out completado en 8.88s
2025-05-23 09:44:56,605 - INFO - [LSTM] Métricas Hold-out (Zona C):
2025-05-23 09:44:56,606 - INFO -   - RMSE: 0.0991
2025-05-23 09:44:56,607 - INFO -   - MAE: 0.0750
2025-05-23 09:44:56,607 - INFO -   - R2: -7.9481
2025-05-23 09:44:56,608 - INFO -   - SMAPE: 150.4459
2025-05-23 09:44:56,609 - INFO - [LSTM] Paso 5: Modelo final (100% de los datos)
2025-05-23 09:45:18,524 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-05-23 09:45:18,590 - INFO - [LSTM] Modelo LSTM guardado en formato H5: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\models\lstm_model.h5
2025-05-23 09:45:18,592 - INFO - [LSTM] Datos adicionales guardados en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\models\lstm_best.pkl
2025-05-23 09:45:18,624 - INFO - Historial de hiperparámetros actualizado y guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\hyperparameters_history.csv
2025-05-23 09:45:18,625 - INFO - Generando pronóstico para LSTM con sequence_length=7
2025-05-23 09:45:20,082 - INFO - Pronóstico generado con 20 valores válidos de 20
2025-05-23 09:45:20,391 - INFO - [LSTM] CSV guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\s&p500_lstm_three_zones.csv
2025-05-23 09:45:20,393 - INFO - [LSTM] Generando gráficos solo con Zona B, Zona C y Forecast
2025-05-23 09:45:20,394 - INFO - [LSTM] Datos para gráficos: 663 registros (excluyendo 1499 de Training)
2025-05-23 09:45:20,814 - INFO - [LSTM] Gráfico principal guardado (sin Zona A): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lstm_three_zones_eval_test_forecast.png
2025-05-23 09:45:21,319 - INFO - [LSTM] Gráfico detallado de horizonte guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lstm_forecast_horizon_detail.png
2025-05-23 09:45:21,931 - INFO - [LSTM] Gráfico desde 2024 guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lstm_desde_2024_hasta_forecast.png
2025-05-23 09:45:22,300 - INFO - [LSTM] Gráfico completo guardado (todas las zonas): C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lstm_three_zones_full.png
2025-05-23 09:45:22,306 - INFO - [LSTM]   - Zona B, C y Forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lstm_three_zones_eval_test_forecast.png
2025-05-23 09:45:22,306 - INFO - [LSTM]   - Horizonte detallado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lstm_forecast_horizon_detail.png
2025-05-23 09:45:22,307 - INFO - [LSTM]   - Desde 2024 hasta forecast: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lstm_desde_2024_hasta_forecast.png
2025-05-23 09:45:22,308 - INFO - [LSTM]   - Histórico completo: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\lstm_three_zones_full.png
2025-05-23 09:45:22,549 - INFO - [LSTM] Procesamiento completo en 110.88s
2025-05-23 09:45:22,552 - INFO - === Completado LSTM en 110.88s ===
2025-05-23 09:45:22,828 - INFO - Archivo final de predicciones guardado en C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\all_models_predictions.csv
2025-05-23 09:45:23,291 - INFO - Gráfico comparativo de todos los modelos guardado: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\charts\all_models_comparison.png
2025-05-23 09:45:23,532 - INFO - Resumen de métricas guardado en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\resumen_metricas.csv
2025-05-23 09:45:23,546 - INFO - Tabla comparativa de zonas guardada en: C:\Users\natus\Documents\Trabajo\PEDRO_PEREZ\Proyecto_Mercado_de_Valores\SP500_INDEX_Analisis\data\4_results\metrics_three_zones.csv
2025-05-23 09:45:23,773 - INFO - Proceso completo terminado en 187.67s
